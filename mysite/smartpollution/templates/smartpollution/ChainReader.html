<html>
<head>
    <title>JavaScript API</title>
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js">


</head>

<body>
<p id="demo">blio</p>
<div class="header">
    <h3>JavaScript API</h3>
</div>
<script src='../../static/smartpollution/web3.min.js'></script>
<script src="../../static/smartpollution/jquery-3.1.1.min.js"></script>
<script>

    var Web3 = require('web3');
    var web3 = new Web3(new Web3.providers.HttpProvider('https://ropsten.infura.io/6I3dntS0W3179HBtMu0X'));
    var version = web3.version.api;

    var abi = '[ { "constant": false, "inputs": [ { "name": "_value", "type": "int32" } ], "name": "changeLowerTrigger", "outputs": [], "payable": false, "type": "function" }, { "constant": true, "inputs": [], "name": "metric", "outputs": [ { "name": "name", "type": "string", "value": "place_holder_metric_name_to_be_autogenerated" }, { "name": "value", "type": "int32", "value": "666" } ], "payable": false, "type": "function" }, { "constant": false, "inputs": [ { "name": "_value", "type": "int32" } ], "name": "changeUpperTrigger", "outputs": [], "payable": false, "type": "function" }, { "constant": false, "inputs": [ { "name": "_value", "type": "int32" } ], "name": "update", "outputs": [], "payable": false, "type": "function" }, { "anonymous": false, "inputs": [ { "indexed": false, "name": "_value", "type": "int32" } ], "name": "ValueChanged", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": false, "name": "_alarm", "type": "string" }, { "indexed": false, "name": "_value", "type": "int32" } ], "name": "Alarm", "type": "event" } ]';
    var abi = JSON.parse(abi);

    var contAbi = web3.eth.contract(abi);
    var cont = contAbi.at('0x3B03c46Dfc878FeF9fAe8de4E32a6718f2E250e9');
    //var events = cont.allEvents({fromBlock: 500000, toBlock: 'latest'});
    //var temp_str='';
    //events.get(function(error, result){ temp_str=JSON.stringify(result);});
    document.getElementById("demo").innerHTML = cont.metric();
</script>
<p id="demo"></p>
<div class="jumbotron">
    <h5>Coinbase Address: <strong id="coinbase"></strong></h5>
    <h5>Balance: <strong id="balance"></strong></h5>
    <h5>Latest Block Number: <strong id="latestBlock"></strong></h5>
    <h5>Latest Block Timestamp: <strong id="latestBlockTimestamp"></strong></h5>
    <h5>Latest Block Hash: <strong id="latestBlockHash"></strong></h5>
    <h5>Contract String: <strong id="contractString"></strong></h5>
    <h5>Favourite Python: <strong id="favouritePython"></strong></h5>
    <br>
</div>

</body>

</html>